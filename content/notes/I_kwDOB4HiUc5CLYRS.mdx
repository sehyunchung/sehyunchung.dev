---
id: I_kwDOB4HiUc5CLYRS
title: nextjs `.env` on Amplify (👎👎👎👎👎)
createdAt: 2022-01-21T10:02:06Z
labels:
  - aws
  - amplify
---

1. next-auth로 auth 를 이케저케한 프로젝트를 앰플리파이에 배포해봤음
2. `signIn`시 서버에러 발생
3. error message was like this:
   ```[next-auth][error][CLIENT_FETCH_ERROR] 
   https://next-auth.js.org/errors#client_fetch_error Unexpected token < in JSON at position 0 {error: {…}, path: 'providers', message: 
   'Unexpected token < in JSON at position 0'}
   ```
4. 알아보니 amplify web ui에서 입력한 env var가 안먹는 것이었음
5. amplify.yml에 아래와 같은 짓을 하는 수 밖에 없었음
   ```
   - echo "NEXTAUTH_SECRET=$NEXTAUTH_SECRET" >> .env
   - echo "NEXTAUTH_URL=$NEXTAUTH_URL" >> .env
   ```
