{"id":"I_kwDOB4HiUc5nsT7A","title":"ğŸ«  Hydration Mismatch ğŸ«  (2)","content":"[ìš”ê¸°](/til/I_kwDOB4HiUc5noRP4)ì„œ ì´ê²ƒ ì €ê²ƒ í•´ë´¤ëŠ”ë° ë‹¤ ë³„ë¡œì¸ ê²ƒ ê°™ë‹¤. ì™œëƒë©´ ë‹¤ hydration mismatchë¥¼ í•´ê²°í•˜ëŠ” ê²Œ ì•„ë‹ˆê³  í”¼í•´ê°€ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì¸ë“¯...\r\n\r\nê·¸ëŸ¬ë‹ˆê¹Œ ì• ì‹œë‹¹ì´ˆ 'mismatch'ê°€ ë°œìƒí•˜ëŠ” ê±´\r\n\r\n1. client stateê°€ clientì—ì„œë§Œ ì•¡ì„¸ìŠ¤ ê°€ëŠ¥í•œ ê³³ì— persist ë˜ì–´ìˆì–´ì„œ\r\n2. serverì—ì„œ ì•¡ì„¸ìŠ¤ê°€ ì•ˆë˜ë‹ˆê¹Œ\r\n3. UI ìƒíƒœê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ë°–ì— ì—†ë‹¤.\r\n\r\nì¸ë° ê·¸ë ‡ë‹¤ë©´\r\n\r\n1. client state persistë¥¼\r\n2. serverì—ì„œ ì•¡ì„¸ìŠ¤ ê°€ëŠ¥í•œ ê³³ì— í•˜ë©´ ë˜ëŠ” ê²ƒì‰ê²Œë¡±.\r\n\r\nê·¸ë˜ì„œ ì¢€ ì†ì´ ê°€ì§€ë§Œ ê± ì´ë ‡ê²Œ í•´ë´¤ëŠ”ë°,\r\n\r\n1. persistì—” `cookie`ë¥¼ ì‚¬ìš©í•œë‹¤.\r\n4. ì™œëƒë©´ ì¿ í‚¤ëŠ” ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì½ê¸° ê°€ëŠ¥ì´ë¯€ë¡œ. ì•”íŠ¼ ê·¸ë˜ì„œ í”Œë¡œìš°ëŠ”,\r\n1. ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ `cookie`ë¥¼ ì½ì–´ì„œ ê³  ì•ˆì— ë“¤ì–´ìˆëŠ” persisted stateë¥¼ ê°€ì ¸ì˜¨ë‹¤.\r\n3. mismatchê°€ ë°œìƒí•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì— ìœ„ stateë¥¼ ë„˜ê²¨ì¤„ propì„ í•˜ë‚˜ ëš«ëŠ”ë‹¤.\r\n5. ê·¸ë¦¬ê³  ê°™ì€ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì— `useState`ë¡œ local stateë¥¼ í•˜ë‚˜ ë§Œë“œëŠ”ë°,\r\n6. ë§Œë“¤ë©´ì„œ initialStateë¡œ ìœ„ ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°›ì•„ì˜¨ propì„ ë„˜ê²¨ì¤€ë‹¤.\r\n7. `useEffect`ë¥¼ í•˜ë‚˜ ì¶”ê°€í•´ì„œ\r\n8. í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ ì“°ê³  ìˆëŠ” persisted storeì„ local stateì— ë¬¶ì–´ì¤€ë‹¤.\r\n9. ê¹…ê¹Œ ëŒ€ëµ\r\n   ```ts\r\n   export function useSyncedState<T>(clientState: T, serverState?: T) {\r\n     const [state, setState] = React.useState<T>(serverState ?? clientState)\r\n\r\n     React.useEffect(() => {\r\n       setState(clientState)\r\n     }, [clientState])\r\n \r\n     return state\r\n   }\r\n   ```\r\n11. ì™ˆë£Œ\r\n\r\nì´ëŸ¬ë©´\r\n1. ì–´ì°¨í”¼ ì„œë²„ë„ í´ë¼ì´ì–¸íŠ¸ë„ ê°™ì€ ê±¸ ë³´ê³  ìˆìœ¼ë¯€ë¡œ ì• ì‹œë‹¹ì´ˆ mismatchê°€ ì•„ë‹˜.\r\n2. hydrationì´ ë˜ê¸° ì „ì— ì´ë¯¸ ê°™ì€ ìƒíƒœì˜ UIê°€ ë³´ì´ë¯€ë¡œ ê¹œë¹¡ì„ ê°™ì€ ê²Œ ì—†ìŒ.\r\n\r\n<BoxDrawn variant=\"arrow\" cols={15} rows={5} className=\"text-xl font-bold m-8\">êµ³</BoxDrawn>\r\n\r\n---\r\nê·¼ë°:\r\n\r\n1. ì„œë²„ í˜¸ì¶œì„ í•´ì•¼ ë¨\r\n1. ê·¸ë˜ì„œ ìš”ë ‡ê²Œ í•œ ì»´í¬ë„ŒíŠ¸ê°€ ë“¤ì–´ìˆëŠ” í˜ì´ì§€ëŠ” static exportê°€ ì•ˆë¨","createdAt":"2023-06-03T16:41:00Z","labels":["react","RSC","next.js","cookie"]}